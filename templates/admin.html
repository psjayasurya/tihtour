<!DOCTYPE html>
<html>
<head>
    <title>Update Hotspot</title>
<style>
    body { 
               font-family: Arial, sans-serif; 
        margin: 40px; 
       background-color: #fa9804;
        color: #fff;
        
    }

    /* Add a semi-transparent background to form for readability */
    form {
        background: rgba(0, 0, 0, 0.6);
        padding: 20px;
        border-radius: 10px;
        width: fit-content;
    }

    label { 
        display: block; 
        margin-top: 10px; 
    }

    input, select, textarea { 
        width: 300px; 
        padding: 5px; 
        margin-top: 5px; 
        border-radius: 5px;
        border: none;
    }

    button { 
        margin-top: 20px; 
        padding: 10px 20px; 
        border: none;
        border-radius: 5px;
        background: #4CAF50;
        color: white;
        font-size: 16px;
        cursor: pointer;
    }

    button:hover {
        background: #45a049;
    }

    #response { 
        margin-top: 20px; 
        font-weight: bold; 
        color: lightgreen; 
        white-space: pre-wrap; 
    }

     #header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 70px;
    background: linear-gradient(135deg, #f36b0a00, #d3540000);
    color:white;
    display: flex;
    align-items: center; /* vertically center */
    justify-content: center; /* horizontally center everything */
    padding: 0 20px;
    z-index: 1000;
    text-align: center;
    margin-top: 10px;
}

.logo-container {
    display: flex;
    align-items: center; /* vertically align image and text */
    gap: 10px; /* space between image and text */
}

.logo-container img {
    height: 50px;
    border-radius: 50%;
}

.institute-name {
    font-size: 2rem;
    font-weight: 600;
}

.department-name {
    font-size: 1rem;
    opacity: 0.9;
}
</style>

</head>
<body>

    <div id="header">
    <div class="logo-container">
        <img src="static/images/hub.jpg" alt="IIT Tirupati Logo">
        <div>
            <div class="institute-name">IIT Tirupati Navavishkar I-Hub Foundation</div>
            <div class="department-name"><marquee  style="color: rgb(61, 247, 5); font-size: medium;"> Developed by Remote Sensing & GIS Lab</marquee></div>
        </div>
    </div>
</div>



<form id="updateForm">
    <label>Update Info Hotspot</label>
    <label>Scene ID (required):</label>
    <select id="scene_id" required>
        <option value="">--Select Scene--</option>
    </select>

    <label>Title to filter (optional):</label>
    <select id="title">
        <option value="">--Select Title--</option>
    </select>

    <label>New Title (optional):</label>
    <input type="text" id="new_title" name="new_title">

    <label>New Yaw:</label>
    <input type="number" step="any" id="yaw" name="yaw">

    <label>New Pitch:</label>
    <input type="number" step="any" id="pitch" name="pitch">

    <label>New Text:</label>
    <textarea id="text" name="text"></textarea>

    <button type="submit">Update Hotspot</button>
</form>

<div id="response"></div>

<script>
// Load Scene IDs
async function loadSceneIDs() {
    try {
        const res = await fetch("/scene_ids");
        const ids = await res.json();
        const select = document.getElementById("scene_id");

        ids.forEach(id => {
            const option = document.createElement("option");
            option.value = id;
            option.textContent = id;
            select.appendChild(option);
        });
    } catch(err) {
        console.error("Failed to load scene IDs:", err);
    }
}

// Load Titles when a scene is selected
async function loadTitles(sceneId) {
    const titleSelect = document.getElementById("title");
    titleSelect.innerHTML = '<option value="">--Select Title--</option>'; // reset

    if (!sceneId) return;

    try {
        const res = await fetch(`/titles/${sceneId}`);
        const titles = await res.json();

        titles.forEach(title => {
            const option = document.createElement("option");
            option.value = title;
            option.textContent = title;
            titleSelect.appendChild(option);
        });
    } catch(err) {
        console.error("Failed to load titles:", err);
    }
}

// When scene changes, load titles
document.getElementById("scene_id").addEventListener("change", function() {
    const sceneId = this.value;
    loadTitles(sceneId);
});

// Submit form
document.getElementById("updateForm").addEventListener("submit", async function(e){
    e.preventDefault();

    const data = {
        scene_id: document.getElementById("scene_id").value
    };

    const title = document.getElementById("title").value;
    if(title) data.title = title;

    const new_title = document.getElementById("new_title").value;
    if(new_title) data.new_title = new_title;

    const yaw = document.getElementById("yaw").value;
    if(yaw) data.yaw = parseFloat(yaw);

    const pitch = document.getElementById("pitch").value;
    if(pitch) data.pitch = parseFloat(pitch);

    const text = document.getElementById("text").value;
    if(text) data.text = text;

    try {
        const res = await fetch("/update_hotspot", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById("response").innerText = JSON.stringify(result, null, 2);
    } catch(err) {
        document.getElementById("response").innerText = "Error: " + err;
    }
});

// Initialize dropdowns
loadSceneIDs();
</script>

</body>
</html>
